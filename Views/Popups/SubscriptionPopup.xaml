<?xml version="1.0" encoding="utf-8" ?>
<mopup:PopupPage
    x:Class="Vakilaw.Views.Popups.SubscriptionPopup"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:mopup="clr-namespace:Mopups.Pages;assembly=Mopups"
    xmlns:converters="clr-namespace:Vakilaw.Converters"
    BackgroundColor="#80000000" FlowDirection="RightToLeft">

    <mopup:PopupPage.Resources>
        <ResourceDictionary>
            <converters:InverseBoolConverter x:Key="InverseBoolConverter"/>
        </ResourceDictionary>
    </mopup:PopupPage.Resources>

    <mopup:PopupPage.Content>
        <Border
            Padding="20"
            StrokeShape="RoundRectangle 12"
            BackgroundColor="#1b263b"
            HorizontalOptions="Center"
            VerticalOptions="Center"
            WidthRequest="340">

            <VerticalStackLayout Spacing="15">

                <!-- Ø¹Ù†ÙˆØ§Ù† -->
                <Label Text="Ø§Ø¹ØªØ¨Ø§Ø± Ù„Ø§ÛŒØ³Ù†Ø³ Ø´Ù…Ø§ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª" FontAttributes="Bold" FontSize="16" HorizontalOptions="Center" TextColor="Red"/>
                <Border StrokeThickness="2" StrokeShape="RoundRectangle 5" Stroke="White">
                    <HorizontalStackLayout>
                        <Label Text="Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ ÙØ¹Ø§Ù„Ø³Ø§Ø²ÛŒ Ù„Ø§ÛŒØ³Ù†Ø³:" FontAttributes="Bold" FontSize="14" HorizontalOptions="Center" TextColor="White" Padding="10,5,35,0"/>
                        <Button Text="Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ" Command="{Binding ActiveLicenseTutorialCommand}" BackgroundColor="Transparent" TextColor="Gold" FontSize="16" FontAttributes="Bold" Margin="0,-12,0,0" Padding="5,10,0,0"/>
                    </HorizontalStackLayout>
                </Border>
               
              
                <!-- ÙˆØ¶Ø¹ÛŒØª Trial -->
                <StackLayout IsVisible="{Binding IsTrialActive}">
                    <Label Text="Trial ÙØ¹Ø§Ù„ Ø§Ø³Øª ØªØ§:" FontAttributes="Bold" TextColor="White"/>
                    <Label Text="{Binding TrialEndDate, StringFormat='{}{0:yyyy/MM/dd}'}" TextColor="Lime"/>
                </StackLayout>

                <!-- Ù†Ù…Ø§ÛŒØ´ DeviceId -->
                <Border BackgroundColor="#1a1a1a" Padding="10" StrokeShape="RoundRectangle 8">
                    <VerticalStackLayout>
                        <Label Text="Ú©Ù„ÛŒØ¯ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø´Ù…Ø§:" FontAttributes="Bold" TextColor="Gold"/>
                        <Label Text="{Binding DeviceId}" HorizontalTextAlignment="Center" FontSize="12" TextColor="White" LineBreakMode="CharacterWrap"/>
                        <Button Text="ðŸ“‹ Ú©Ù¾ÛŒ"  Margin="5"
                                Command="{Binding CopyDeviceIdCommand}" 
                                BackgroundColor="#444" 
                                TextColor="White"
                                CornerRadius="8"
                                FontSize="12"/>
                    </VerticalStackLayout>
                </Border>

                <!-- Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§ / Ù¾ÛŒØ§Ù… -->
                <Label Text="{Binding ErrorMessage}" 
                       TextColor="Red" 
                       IsVisible="{Binding ErrorMessage, Converter={StaticResource StringNotNullOrEmptyConverter}}"
                       HorizontalOptions="Center"
                       FontAttributes="Bold"/>

                <Border StrokeShape="RoundRectangle 5" StrokeThickness="3" Stroke="GhostWhite">
                    <!-- ÙˆØ±ÙˆØ¯ÛŒ Ù„Ø§ÛŒØ³Ù†Ø³ -->
                    <Editor Placeholder="Ú©Ù„ÛŒØ¯ Ù„Ø§ÛŒØ³Ù†Ø³ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"
                    HeightRequest="100"
                    AutoSize="TextChanges"
                    Text="{Binding LicenseKey}"
                    MaxLength="2000"
                    IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}"
                    BackgroundColor="White"
                    TextColor="Black"/>
                </Border>
               

                <!-- Picker Ø§Ø´ØªØ±Ø§Ú© (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø±Ø§Ù‡Ù†Ù…Ø§) -->
                <Picker Title="Ù†ÙˆØ¹ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ (Ø±Ø§Ù‡Ù†Ù…Ø§)"
                        ItemsSource="{Binding SubscriptionOptions}"
                        SelectedItem="{Binding SelectedSubscription}"
                        IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}"/>

                <!-- Activity Indicator -->
                <ActivityIndicator IsRunning="{Binding IsProcessing}" 
                                   IsVisible="{Binding IsProcessing}" 
                                   HorizontalOptions="Center"/>

                <!-- Ø¯Ú©Ù…Ù‡ ÙØ¹Ø§Ù„Ø³Ø§Ø²ÛŒ -->
                <Button Text="ÙØ¹Ø§Ù„Ø³Ø§Ø²ÛŒ"
                        Command="{Binding ActivateLicenseCommand}"
                        IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}"
                        BackgroundColor="ForestGreen" TextColor="White" CornerRadius="8"/>

                <Button Text="Ø§Ù†ØµØ±Ø§Ù"
                        Command="{Binding ClosePopupCommand}"
                        IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}"
                        BackgroundColor="LightGray" CornerRadius="8"/>

            </VerticalStackLayout>
        </Border>
    </mopup:PopupPage.Content>
</mopup:PopupPage>
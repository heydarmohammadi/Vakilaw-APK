<?xml version="1.0" encoding="utf-8" ?>
<mopup:PopupPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                 xmlns:mopup="clr-namespace:Mopups.Pages;assembly=Mopups"
                 xmlns:vm="clr-namespace:Vakilaw.ViewModels"
                 x:Class="Vakilaw.Views.Popups.EditCasePopup" BackgroundColor="#80000000" FlowDirection="RightToLeft">


    <ContentView VerticalOptions="Center" HorizontalOptions="Center">
        <Border Padding="20" Margin="20"
                StrokeShape="RoundRectangle 12"
                BackgroundColor="#1b263b"
                WidthRequest="340" MaximumHeightRequest="700">

            <ScrollView>
                <VerticalStackLayout Spacing="10">
                    <Label Text="ÙˆÛŒØ±Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª" FontFamily="IRANSansWeb" FontSize="20" TextColor="Gold"/>

                    <Entry Text="{Binding CourtName}" FontFamily="IRANSansWeb" Placeholder="Ø¯Ø§Ø¯Ú¯Ø§Ù‡"/>
                    <Entry Text="{Binding JudgeName}" FontFamily="IRANSansWeb" Placeholder="Ù‚Ø§Ø¶ÛŒ"/>
                    <Picker FontFamily="IRANSansWeb"
                        SelectedItem="{Binding Status, Mode=TwoWay}"
                        Title="Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ¶Ø¹ÛŒØª"
                        TitleColor="DarkGray">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>Ø¯Ø±Ø­Ø§Ù„ Ø±Ø³ÛŒØ¯Ú¯ÛŒ</x:String>
                                <x:String>Ù…Ø®ØªÙˆÙ…Ù‡</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>
                    <Entry Text="{Binding EndDate}" IsEnabled="{Binding EndDateIsEnabled}" FontFamily="IRANSansWeb" Placeholder="ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù†"/>

                    <Border StrokeShape="RoundRectangle 5" StrokeThickness="3" Stroke="GhostWhite">
                        <Editor FontFamily="IRANSansWeb" Placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª ..." PlaceholderColor="DarkGray"
                        Text="{Binding Description}" AutoSize="TextChanges" MaxLength="2000"
                        BackgroundColor="WhiteSmoke" TextColor="Black" HeightRequest="100"/>
                    </Border>

                    <!-- Ø§Ù†ØªØ®Ø§Ø¨ Ù¾ÛŒÙˆØ³Øªâ€ŒÙ‡Ø§ -->
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Ù¾ÛŒÙˆØ³Øª Ù‡Ø§:" FontAttributes="Bold" TextColor="White"/>
                        <Button Text="ðŸ“Ž Ø§ÙØ²ÙˆØ¯Ù† ÙØ§ÛŒÙ„" 
                        Command="{Binding AddAttachmentCommand}"
                        FontFamily="IRANSansWeb"
                        BackgroundColor="DodgerBlue" 
                        TextColor="White"
                        FontAttributes="Bold"/>

                        <CollectionView ItemsSource="{Binding Attachments}" MaximumHeightRequest="120" VerticalScrollBarVisibility="Always">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <!-- Ø¯Ú©Ù…Ù‡ Ø­Ø°Ù Ø³Ù…Øª Ú†Ù¾ -->
                                            <ColumnDefinition Width="*"/>
                                            <!-- Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ù…ÛŒØ§Ù†Ù‡ -->
                                        </Grid.ColumnDefinitions>
                                        <Button Text="âŒ" Grid.Column="0"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type vm:EditCasePopupViewModel}}, Path=RemoveAttachmentCommand}" 
                                        CommandParameter="{Binding .}" 
                                        BackgroundColor="Transparent" TextColor="Red"/>
                                        <Label Text="{Binding FileName}" TextColor="Gold" VerticalOptions="Center" Grid.Column="1"/>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                    
                    <HorizontalStackLayout HorizontalOptions="Center" Spacing="10">
                        <Button Text="Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª" Command="{Binding SaveCommand}" BackgroundColor="DodgerBlue" FontFamily="IRANSansWeb" FontAttributes="Bold" TextColor="White"/>
                        <Button Text="Ø§Ù†ØµØ±Ø§Ù" Command="{Binding CancelCommand}" BackgroundColor="Gray" FontFamily="IRANSansWeb" FontAttributes="Bold" TextColor="White"/>
                    </HorizontalStackLayout>

                </VerticalStackLayout>
            </ScrollView>
        </Border>
    </ContentView>
</mopup:PopupPage>